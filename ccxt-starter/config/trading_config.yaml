# CCXT Trading Starter Kit - Configuration
version: "1.0"

# Exchanges
exchanges:
  coinbase:
    enabled: true
    sandbox: false  # Set to true for testnet/paper trading
    rate_limit: 10  # API calls per second (stay below exchange limits)
    ip_allowlist:  # Add your server IPs (configure in exchange API settings)
      - "YOUR_SERVER_IP_1"
      - "YOUR_SERVER_IP_2"

  kraken:
    enabled: true
    sandbox: false
    rate_limit: 15
    ip_allowlist:
      - "YOUR_SERVER_IP_1"

  binanceus:
    enabled: false  # Enable if using Binance.US
    sandbox: false
    rate_limit: 20
    ip_allowlist:
      - "YOUR_SERVER_IP_1"

  # Stock trading via Alpaca
  alpaca:
    enabled: false
    sandbox: true  # Paper trading recommended for testing
    rate_limit: 200
    base_url: "https://paper-api.alpaca.markets"  # Use live URL for production

# Risk Limits
risk:
  # Order limits
  max_order_value: 10000  # USD (single order)
  max_order_quantity: 1.0  # BTC (adjust per asset)

  # Daily limits
  max_daily_volume: 50000  # USD (across all exchanges)
  max_daily_trades: 100  # Number of trades per day

  # Position limits
  max_position_size: 25000  # USD (per asset)
  max_portfolio_concentration: 0.30  # Max 30% in single asset

  # Loss limits
  max_drawdown_pct: 15  # Stop trading if portfolio drops 15% from peak
  daily_loss_limit: 5000  # USD (stop trading if daily loss exceeds)

  # Kill switch
  kill_switch_enabled: true  # Emergency stop
  auto_kill_on_max_drawdown: true  # Activate kill switch if max drawdown hit

# Withdrawal Controls
withdrawals:
  # Approval settings
  auto_approve_under: 0  # USD (0 = all withdrawals require manual approval)
  approval_method: "email"  # email, sms, or dashboard

  # Whitelisted addresses (only allow withdrawals to these)
  recipient_allowlist:
    BTC:
      - "bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh"  # Example Bitcoin address
    ETH:
      - "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb"  # Example Ethereum address
    # Add more as needed

  # Daily limits
  max_daily_withdrawal: 10000  # USD

# Logging
logging:
  level: INFO  # DEBUG, INFO, WARNING, ERROR
  format: json  # json or text
  retention_days: 2555  # 7 years for IRS compliance
  immutable: true  # Append-only logs (tamper-evident)
  file_path: /app/logs/trading.log

# Reconciliation
reconciliation:
  enabled: true
  frequency: "daily"  # daily, hourly, or manual
  schedule: "03:00"  # UTC time (3 AM daily)
  alert_threshold: 0.01  # USD (alert if discrepancy > 1 cent)
  auto_sync: false  # Automatically sync missing trades (use with caution)

# Monitoring & Alerts
monitoring:
  prometheus_enabled: true
  prometheus_port: 9090

  grafana_enabled: true
  grafana_port: 3000

  healthcheck_interval: 60  # seconds

  # Alert channels
  alerts:
    email:
      enabled: true
      smtp_host: "smtp.gmail.com"
      smtp_port: 587
      smtp_user: "alerts@veteranholdingco.com"
      smtp_password_secret: "secret/monitoring/smtp_password"  # Vault path
      recipient: "admin@veteranholdingco.com"

    sms:
      enabled: false
      provider: "twilio"  # twilio or aws_sns
      twilio_account_sid_secret: "secret/monitoring/twilio_sid"
      twilio_auth_token_secret: "secret/monitoring/twilio_token"
      recipient: "+15551234567"

    slack:
      enabled: false
      webhook_url_secret: "secret/monitoring/slack_webhook"

# Database
database:
  host: postgres  # Docker service name or IP
  port: 5432
  name: trading
  user: trading_user
  password_secret: "secret/database/password"  # Vault path
  pool_size: 10
  backup_enabled: true
  backup_schedule: "daily"  # daily, weekly, or manual
  backup_retention_days: 90

# API Rate Limiting (global)
rate_limiting:
  enabled: true
  requests_per_second: 10  # Global limit across all exchanges
  burst_size: 20  # Allow bursts

# Paper Trading (for testing strategies)
paper_trading:
  enabled: false  # Set to true to simulate trades without real money
  initial_balance:
    USD: 10000
    BTC: 0
    ETH: 0

# Tax Reporting
tax:
  jurisdiction: "US"  # US, UK, EU, etc.
  cost_basis_method: "FIFO"  # FIFO, LIFO, or specific_identification
  generate_8949: true  # Generate Form 8949 data for IRS
  output_path: /app/reports/tax

# Feature Flags (for gradual rollout)
features:
  advanced_order_types: false  # Stop-loss, take-profit, trailing stop
  multi_exchange_arbitrage: false  # Future feature
  automated_rebalancing: false  # Future feature
  tax_loss_harvesting: false  # Future feature

# Compliance
compliance:
  kyc_required: true
  kyc_documents_path: /app/kyc  # Encrypted storage
  aml_monitoring: true
  recordkeeping_years: 7  # IRS requirement

# Notifications (for client updates)
notifications:
  daily_summary: true  # Email daily summary at end of day
  trade_confirmations: true  # Email after each trade
  risk_alerts: true  # Immediate alerts for risk events
